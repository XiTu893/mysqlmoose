<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mysqlmoose - A mongoose-compatible API for MySQL 8.0</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f6f8fa;
        }
        .container {
            background-color: white;
            padding: 40px;
            border-radius: 6px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        h1, h2, h3, h4, h5, h6 {
            color: #24292e;
            margin-top: 24px;
            margin-bottom: 16px;
            font-weight: 600;
            line-height: 1.25;
        }
        h1 {
            font-size: 2em;
            border-bottom: 1px solid #eaecef;
            padding-bottom: 0.3em;
        }
        h2 {
            font-size: 1.5em;
            border-bottom: 1px solid #eaecef;
            padding-bottom: 0.3em;
        }
        h3 {
            font-size: 1.25em;
        }
        p {
            margin-top: 0;
            margin-bottom: 16px;
        }
        pre {
            background-color: #f6f8fa;
            border-radius: 3px;
            font-size: 85%;
            line-height: 1.45;
            overflow: auto;
            padding: 16px;
            margin-bottom: 16px;
        }
        code {
            background-color: rgba(27,31,35,0.05);
            border-radius: 3px;
            font-size: 85%;
            margin: 0;
            padding: 0.2em 0.4em;
        }
        pre code {
            background-color: transparent;
            padding: 0;
        }
        ul, ol {
            margin-top: 0;
            margin-bottom: 16px;
            padding-left: 2em;
        }
        li {
            margin-top: 0.25em;
        }
        a {
            color: #0366d6;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        .badge {
            display: inline-block;
            padding: 0.25em 0.4em;
            font-size: 75%;
            font-weight: 700;
            line-height: 1;
            color: #fff;
            background-color: #6f42c1;
            border-radius: 0.25rem;
            margin-right: 0.5em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>mysqlmoose</h1>
        <p><span class="badge">Node.js</span><span class="badge">MySQL</span><span class="badge">Mongoose</span><span class="badge">ES5</span></p>
        
        <h2>Overview</h2>
        <p>A mongoose-compatible API for MySQL 8.0, written in ES5 for Node.js.</p>
        
        <h3>概述</h3>
        <p>一个兼容 mongoose API 的 MySQL 8.0 连接库，使用 ES5 标准编写，可在 Node.js 环境中使用。</p>
        <p><strong>迁移优势：</strong>如果您之前使用的是 MongoDB + Mongoose，现在可以无缝迁移到 MySQL 8.0，无需修改现有代码，直接替换连接方式即可。</p>
        
        <h2>Features</h2>
        <ul>
            <li>Compatible with mongoose API</li>
            <li>Connects to MySQL 8.0</li>
            <li>Supports Schema definition</li>
            <li>Auto-creates tables based on Schema</li>
            <li>Stores first-level fields directly in tables</li>
            <li>Stores object fields as JSON type in MySQL</li>
            <li>Supports basic CRUD operations</li>
            <li>Supports callback functions</li>
            <li>Supports chained queries</li>
            <li>Supports nested JSON field queries</li>
            <li><strong>Seamless Migration:</strong> Migrate from MongoDB + Mongoose to MySQL 8.0 without any code changes</li>
        </ul>
        
        <h3>特性</h3>
        <ul>
            <li>兼容 mongoose API</li>
            <li>连接 MySQL 8.0</li>
            <li>支持 Schema 定义</li>
            <li>基于 Schema 自动创建表结构</li>
            <li>第一层字段直接存储至表格</li>
            <li>对象类型字段存储为 MySQL JSON 类型</li>
            <li>支持基本 CRUD 操作</li>
            <li>支持回调函数</li>
            <li>支持链式查询</li>
            <li>支持 JSON 字段嵌套查询</li>
            <li><strong>无缝迁移：</strong>从 MongoDB + Mongoose 迁移到 MySQL 8.0 无需修改现有代码</li>
        </ul>
        
        <h2>Installation</h2>
        <pre><code>npm install</code></pre>
        
        <h3>安装</h3>
        <pre><code>npm install</code></pre>
        
        <h2>Usage</h2>
        
        <h3>Connect to Database</h3>
        <pre><code>var mysqlmoose = require('./index');

mysqlmoose.connect({
  host: 'localhost',
  user: 'root',
  password: 'your_password',
  database: 'test'
}).then(connection => {
  console.log('Connected to MySQL database');
  // Your code here
}).catch(error => {
  console.error('Error connecting to database:', error);
});</code></pre>
        
        <h4>连接数据库</h4>
        <pre><code>var mysqlmoose = require('./index');

mysqlmoose.connect({
  host: 'localhost',
  user: 'root',
  password: 'your_password',
  database: 'test'
}).then(connection => {
  console.log('Connected to MySQL database');
  // Your code here
}).catch(error => {
  console.error('Error connecting to database:', error);
});</code></pre>
        
        <h3>Define Schema</h3>
        <pre><code>var userSchema = mysqlmoose.Schema({
  name: String,
  age: Number,
  isActive: Boolean,
  profile: Object, // Will be stored as JSON
  createdAt: Date
});</code></pre>
        
        <h4>定义 Schema</h4>
        <pre><code>var userSchema = mysqlmoose.Schema({
  name: String,
  age: Number,
  isActive: Boolean,
  profile: Object, // 将存储为 JSON
  createdAt: Date
});</code></pre>
        
        <h3>Create Model</h3>
        <pre><code>var User = mysqlmoose.model('User', userSchema);</code></pre>
        
        <h4>创建 Model</h4>
        <pre><code>var User = mysqlmoose.model('User', userSchema);</code></pre>
        
        <h3>CRUD Operations</h3>
        
        <h4>Create</h4>
        <pre><code>var newUser = await User.create({
  name: 'John Doe',
  age: 30,
  isActive: true,
  profile: {
    email: 'john@example.com',
    address: '123 Main St',
    phone: '555-1234'
  },
  createdAt: new Date()
});</code></pre>
        
        <h5>创建</h5>
        <pre><code>var newUser = await User.create({
  name: 'John Doe',
  age: 30,
  isActive: true,
  profile: {
    email: 'john@example.com',
    address: '123 Main St',
    phone: '555-1234'
  },
  createdAt: new Date()
});</code></pre>
        
        <h4>Find</h4>
        <pre><code>// Find all users
var users = await User.find({});

// Find user by condition
var user = await User.findOne({ name: 'John Doe' });

// Find user by ID
var userById = await User.findById(1);</code></pre>
        
        <h5>查询</h5>
        <pre><code>// 查询所有用户
var users = await User.find({});

// 根据条件查询用户
var user = await User.findOne({ name: 'John Doe' });

// 根据ID查询用户
var userById = await User.findById(1);</code></pre>
        
        <h4>Chained Queries</h4>
        <pre><code>// Using chained queries
User.find()
  .where('isActive', true)
  .sort('age', 'desc')
  .exec((error, users) => {
    if (error) {
      console.error('Error:', error);
    } else {
      console.log('Active users sorted by age:', users);
    }
  });</code></pre>
        
        <h5>链式查询</h5>
        <pre><code>// 使用链式查询
User.find()
  .where('isActive', true)
  .sort('age', 'desc')
  .exec((error, users) => {
    if (error) {
      console.error('Error:', error);
    } else {
      console.log('Active users sorted by age:', users);
    }
  });</code></pre>
        
        <h4>JSON Nested Queries</h4>
        <pre><code>// Query nested JSON fields
User.find()
  .where('profile.email', 'john@example.com')
  .exec((error, users) => {
    if (error) {
      console.error('Error:', error);
    } else {
      console.log('Users with specific email:', users);
    }
  });

// Deep nested queries
User.find()
  .where('profile.address.city', 'Los Angeles')
  .exec()
  .then(users => {
    console.log('Users in Los Angeles:', users);
  });</code></pre>
        
        <h5>JSON嵌套查询</h5>
        <pre><code>// 查询嵌套JSON字段
User.find()
  .where('profile.email', 'john@example.com')
  .exec((error, users) => {
    if (error) {
      console.error('Error:', error);
    } else {
      console.log('Users with specific email:', users);
    }
  });

// 深层嵌套查询
User.find()
  .where('profile.address.city', 'Los Angeles')
  .exec()
  .then(users => {
    console.log('Users in Los Angeles:', users);
  });</code></pre>
        
        <h4>Update</h4>
        <pre><code>await User.update({ id: 1 }, { age: 31, isActive: false });</code></pre>
        
        <h5>更新</h5>
        <pre><code>await User.update({ id: 1 }, { age: 31, isActive: false });</code></pre>
        
        <h4>Delete</h4>
        <pre><code>// Delete one user
await User.deleteOne({ id: 1 });

// Delete multiple users
await User.deleteMany({ isActive: false });</code></pre>
        
        <h5>删除</h5>
        <pre><code>// 删除一个用户
await User.deleteOne({ id: 1 });

// 删除多个用户
await User.deleteMany({ isActive: false });</code></pre>
        
        <h2>Example</h2>
        <p>See <code>example.js</code> for a complete example of how to use mysqlmoose.</p>
        
        <h3>示例</h3>
        <p>请查看 <code>example.js</code> 文件，了解如何完整使用 mysqlmoose。</p>
        
        <h2>Migration from MongoDB</h2>
        <p>Seamlessly migrate from MongoDB + Mongoose to MySQL 8.0 without any code changes.</p>
        
        <h3>从 MongoDB 迁移</h3>
        <p>从 MongoDB + Mongoose 无缝迁移到 MySQL 8.0，无需修改现有代码。</p>
        
        <h4>Before (MongoDB + Mongoose)</h4>
        <pre><code>// 连接 MongoDB
mongoose.connect('mongodb://localhost:27017/mydb');

var userSchema = new mongoose.Schema({
  name: String,
  age: Number,
  profile: Object
});

var User = mongoose.model('User', userSchema);

// 使用
var user = await User.findOne({ name: 'John' });
user.profile.email = 'new@email.com';
await user.save();</code></pre>
        
        <h4>之后 (MySQL + mysqlmoose)</h4>
        <pre><code>// 连接 MySQL（只需修改连接方式）
mysqlmoose.connect({
  host: 'localhost',
  user: 'root',
  password: 'your_password',
  database: 'mydb'
});

// 同样的 Schema 定义（完全相同）
var userSchema = mysqlmoose.Schema({
  name: String,
  age: Number,
  profile: Object
});

var User = mysqlmoose.model('User', userSchema);

// 使用（代码完全相同，无需修改）
var user = await User.findOne({ name: 'John' });
user.profile.email = 'new@email.com';
await user.save();</code></pre>
        
        <h4>迁移步骤</h4>
        <ol>
            <li>将 mongoose 替换为 mysqlmoose</li>
            <li>修改数据库连接配置（从 MongoDB 连接字符串改为 MySQL 连接参数）</li>
            <li>Schema 定义保持不变</li>
            <li>所有 CRUD 操作代码保持不变</li>
            <li>支持原有的链式查询语法</li>
            <li>支持原有的回调函数风格</li>
        </ol>
        
        <h4>支持的操作</h4>
        <ul>
            <li>Model.create() - 创建文档</li>
            <li>Model.find() - 查询文档</li>
            <li>Model.findOne() - 查询单个文档</li>
            <li>Model.findById() - 根据ID查询</li>
            <li>Model.update() - 更新文档</li>
            <li>Model.deleteOne() - 删除单个文档</li>
            <li>Model.deleteMany() - 删除多个文档</li>
            <li>链式查询（where、sort、in、ne、regex 等）</li>
            <li>嵌套 JSON 字段查询</li>
        </ul>
        
        <h2>License</h2>
        <p>GPL v2</p>
        
        <h3>许可证</h3>
        <p>GPL v2</p>
        
        <h2>Author</h2>
        <p>28491599@qq.com</p>
        
        <h3>作者</h3>
        <p>28491599@qq.com</p>
    </div>
</body>
</html>